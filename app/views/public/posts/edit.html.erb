<div class="container">
  <div class="row">
    <div class="col">
      <div class="post-all">
        <div class="post-show">
          <table class= "table">
            <h5>投稿一覧</h5>
            <thead>
              <tr>
                <th>タイトル</th>
                <th>ジャンル名</th>
                <th>料理説明</th>
                <th>料理説明</th>
                <th>値段</th>
                <th>料理一覧へ</th>
             </tr>
            </thead>
            <tbody>
              <tr>
                <td><%= @post.title %></td>
                <td><%= @post.genre_name %></td>
                <td><%= @post.price %></td>
                <td><%= @post.introduction %></td>
                <td>
                  <% @post.images.each do |image| %>
                    <%= image_tag (image.url),width: '30px', height: '30px' %>
                  <% end %>
                </td>
                <td>
                  <%= link_to '料理一覧へ', public_profile_posts_path(@profile.id) ,class: "btn btn-success" %>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#Mymodel">
          料理投稿編集
        </button>
        <div class="post-destroy">
          <%=link_to '投稿を排除する',  public_profile_posts_path(@profile.id),method: :delete,class: "btn btn-danger" %>
        </div>
        <div class="post-item">
          <div class="d-flex flex-row-reverse">
            <%= link_to '全て排除する',  public_profile_post_post_item_destroy_path(@profile.id,@post.id),method: :delete, class: "btn btn-danger" %>
            <%= link_to '料理一覧へ', public_profile_posts_path(@profile.id) ,class: "btn btn-success" %>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th>具材</th>
                <th>値段</th>
                <th>入手場所</th>
                <th>具材説明</th>
                <th>具材画像一覧</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% @post_items.each do |post_item| %>
                <tr>
                  <td><%= post_item.item %></td>
                  <td><%= post_item.price %></td>
                  <td><%= post_item.place %></td>
                  <td><%= post_item.introduction %></td>
                  <td>
                    <% post_item.images.each do |images| %>
                      <%= image_tag (images.url),width: '30px', height: '30px' %>
                    <% end %>
                  </td>
                  <td class="d-flex">
                    <div><%= link_to '料理詳細へ',  public_profile_posts_path(@profile.id,@post.id), class: "btn btn-primary mr-2"  %></div>
                    <div>
                       <%= link_to '排除する',   public_profile_post_post_item_path(@profile.id, @post.id,post_item.id),method: :delete, class: "btn btn-danger" %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="Mymodel" tabindex="-1" role="dialog" aria-labelledby="Mymodel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">料理具材登録</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <%= form_with model: @post,url:   public_profile_post_path(@profile.id, @post.id),local: true do |f| %>
        <div class="modal-body">
          <div class="form-group">
            <div class="m-2">
              <%= f.label 'タイトル' %>
              <%= f.text_field :title %>
            </div>
            <div class="m-2">
              <%= f.label 'ジャンル' %>
              <%= select :post, :genre_name, Post.genre_names.keys.to_a, include_blank: true %>
            </div>
            <div class="m-2">
              <%= f.label '値段' %>
              <%= f.text_field :price %>
            </div>
            <div class="m-2">
              <%= f.label '料理説明' %>
              <%=f.text_area :introduction, class: "padding:20px;" %>
            </div>
            <div class="m-2">
              <%= f.label '料理画像' %>
              <%= f.file_field :images, multiple: true %>
            </div>
            <div class="tag">
              <%= f.label 'タグをつける' %>
              <%= f.text_field :tag_ids,value: @tag_list,\
              placeholder: "複数つけるには','で区切ってください。" %>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">閉じる</button>
              <%= f.submit '投稿する', class: "btn btn-primary" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
